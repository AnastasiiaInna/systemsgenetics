```{r}
setwd("../umap")
source("../downstreamer_functions.r")
source("data/source_olivier.r")
library(umap)


#pc.file      <- "zcat /groups/umcg-wijmenga/prm02/data_projects/Gado/GeneNetwork_V2_01-02-2018/Covariates/PCA/pc-scores1588.txt.gz"
pcs           <- fread(pc.file, data.table=F)
rownames(pcs) <- pcs[,1]
pcs           <- pcs[,-1]
pcs.165       <- pcs[,1:165]
```

```{r}
um <- umap(pcs.165,
           verbose=T,
           n_neighbors=300,
           n_epochs=1000,
           min_dist=8,
           spread=10,
           random_state=5820785,
           transform_state=5820785)
save(um, file="output/umap_cache_v6.Rdata")


km <- kmeans(um$layout, 140)
df.plot <- data.frame(x=um$layout[,1], y=um$layout[,2], cols=as.factor(km$cluster))

p1 <- ggplot(df.plot, aes(x=x, y=y, col=cols)) +
  geom_point(alpha=0.2) 
theme.nature(p1) +
theme(legend.position = "none")

```

